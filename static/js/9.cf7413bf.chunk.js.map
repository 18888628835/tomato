{"version":3,"sources":["pages/Login.tsx","components/config/axiosConfig.ts"],"names":["Main","styled","main","Login","useState","account","password","loginMessage","setLoginMessage","history","useHistory","onLogin","a","ajax","post","push","alert","response","data","errors","onChange","obj","mes","name","className","initialValues","remember","onFinish","Item","rules","required","message","prefix","placeholder","onBlur","e","target","value","type","valuePropName","noStyle","htmlType","to","axios","create","baseURL","headers","interceptors","request","use","config","xToken","localStorage","getItem","error","Promise","reject","setItem"],"mappings":"ufAQA,IAAMA,EAAOC,IAAOC,KAAV,KAyFKC,UA5ED,WAAO,IAAD,EACsBC,mBAAuB,CAC7DC,QAAS,GACTC,SAAU,KAHM,mBACXC,EADW,KACGC,EADH,KAKZC,EAAUC,cACVC,EAAO,uCAAG,8BAAAC,EAAA,6DACNP,EAAsBE,EAAtBF,QAASC,EAAaC,EAAbD,SADH,kBAGNO,IAAKC,KAAK,eAAgB,CAC9BT,UACAC,aALU,uBAONG,EAAQM,KAAK,UAPP,uDASZC,MAAM,KAAMC,SAASC,KAAKC,QATd,yDAAH,qDAYPC,EAAW,SAACC,GAChBb,GAAgB,SAACc,GACf,OAAO,2BAAKA,GAAQD,OAGxB,OACE,eAACrB,EAAD,WACE,sEACA,eAAC,IAAD,CACEuB,KAAK,eACLC,UAAU,aACVC,cAAe,CAAEC,UAAU,GAC3BC,SAAUhB,EAJZ,UAME,cAAC,IAAKiB,KAAN,CACEL,KAAK,UACLM,MAAO,CAAC,CAAEC,UAAU,EAAMC,QAAS,0CAFrC,SAIE,cAAC,IAAD,CACEC,OAAQ,cAAC,IAAD,CAAcR,UAAU,wBAChCS,YAAY,qBACZC,OAAQ,SAACC,GACPf,EAAS,CAAEf,QAAS8B,EAAEC,OAAOC,aAInC,cAAC,IAAKT,KAAN,CACEL,KAAK,WACLM,MAAO,CAAC,CAAEC,UAAU,EAAMC,QAAS,oCAFrC,SAIE,cAAC,IAAD,CACEC,OAAQ,cAAC,IAAD,CAAcR,UAAU,wBAChCc,KAAK,WACLL,YAAY,eACZC,OAAQ,SAACC,GACPf,EAAS,CAAEd,SAAU6B,EAAEC,OAAOC,aAIpC,cAAC,IAAKT,KAAN,UACE,cAAC,IAAKA,KAAN,CAAWL,KAAK,WAAWgB,cAAc,UAAUC,SAAO,EAA1D,SACE,cAAC,IAAD,2CAGJ,sBAAKhB,UAAU,eAAf,UACE,cAAC,IAAD,CACEc,KAAK,UACLG,SAAS,SACTjB,UAAU,oBAHZ,0BADF,MAQK,cAAC,IAAD,CAAMkB,GAAG,UAAT,kD,gCC3Fb,aAIM7B,EAJN,OAIa8B,EAAMC,OAAO,CACxBC,QAAS,uCACTC,QAAS,CACP,WANU,2BAOV,eANc,8BAWlBjC,EAAKkC,aAAaC,QAAQC,KACxB,SAAUC,GACR,IAAMC,EAASC,aAAaC,QAAQ,WAIpC,OAHIF,IACFD,EAAOJ,QAAP,+BAA4CK,IAEvCD,KAET,SAAUI,GACR,OAAOC,QAAQC,OAAOF,MAK1BzC,EAAKkC,aAAa9B,SAASgC,KACzB,SAAUhC,GAKR,OAHIA,EAAS6B,QAAQ,YACnBM,aAAaK,QAAQ,UAAWxC,EAAS6B,QAAQ,YAE5C7B,KAET,SAAUqC,GAER,OAAOC,QAAQC,OAAOF,MAGXzC","file":"static/js/9.cf7413bf.chunk.js","sourcesContent":["import React, { useState } from \"react\";\nimport { Button, Checkbox, Form, Input } from \"antd\";\nimport { UserOutlined, LockOutlined } from \"@ant-design/icons\";\nimport styled from \"styled-components\";\nimport { Link, useHistory } from \"react-router-dom\";\nimport { LoginMessage } from \"../components/config/type\";\nimport ajax from \"../components/config/axiosConfig\";\n\nconst Main = styled.main`\n  max-width: 300px;\n  margin: 0 auto;\n  > h1 {\n    text-align: center;\n  }\n  .login-button {\n    > button {\n      width: 100%;\n      margin-bottom: 20px;\n    }\n  }\n`;\nconst Login = () => {\n  const [loginMessage, setLoginMessage] = useState<LoginMessage>({\n    account: \"\",\n    password: \"\",\n  });\n  const history = useHistory();\n  const onLogin = async () => {\n    const { account, password } = loginMessage;\n    try {\n      await ajax.post(\"sign_in/user\", {\n        account,\n        password,\n      });\n      await history.push(\"/index\");\n    } catch (error) {\n      alert(error.response.data.errors);\n    }\n  };\n  const onChange = (obj: Partial<LoginMessage>) => {\n    setLoginMessage((mes) => {\n      return { ...mes, ...obj };\n    });\n  };\n  return (\n    <Main>\n      <h1>登录番茄土豆</h1>\n      <Form\n        name=\"normal_login\"\n        className=\"login-form\"\n        initialValues={{ remember: true }}\n        onFinish={onLogin}\n      >\n        <Form.Item\n          name=\"account\"\n          rules={[{ required: true, message: \"请输入用户名!\" }]}\n        >\n          <Input\n            prefix={<UserOutlined className=\"site-form-item-icon\" />}\n            placeholder=\"用户名\"\n            onBlur={(e) => {\n              onChange({ account: e.target.value });\n            }}\n          />\n        </Form.Item>\n        <Form.Item\n          name=\"password\"\n          rules={[{ required: true, message: \"请输入密码!\" }]}\n        >\n          <Input\n            prefix={<LockOutlined className=\"site-form-item-icon\" />}\n            type=\"password\"\n            placeholder=\"密码\"\n            onBlur={(e) => {\n              onChange({ password: e.target.value });\n            }}\n          />\n        </Form.Item>\n        <Form.Item>\n          <Form.Item name=\"remember\" valuePropName=\"checked\" noStyle>\n            <Checkbox>记住密码</Checkbox>\n          </Form.Item>\n        </Form.Item>\n        <div className=\"login-button\">\n          <Button\n            type=\"primary\"\n            htmlType=\"submit\"\n            className=\"login-form-button\"\n          >\n            登录\n          </Button>\n          Or <Link to=\"/signup\">现在注册!</Link>\n        </div>\n      </Form>\n    </Main>\n  );\n};\nexport default Login;\n","import axios from \"axios\";\nconst appID = \"23428m5P3TFxUWgDpjgfAkNo\";\nconst appSecret = \"7sSqdQDvUrGrBTBi7FDCeevi\";\n\nconst ajax = axios.create({\n  baseURL: \"https://gp-server.hunger-valley.com/\",\n  headers: {\n    \"t-app-id\": appID,\n    \"t-app-secret\": appSecret,\n  },\n});\n\n// Add a request interceptor\najax.interceptors.request.use(\n  function (config) {\n    const xToken = localStorage.getItem(\"x-token\");\n    if (xToken) {\n      config.headers[\"Authorization\"] = `Bearer ${xToken}`;\n    }\n    return config;\n  },\n  function (error) {\n    return Promise.reject(error);\n  }\n);\n\n// Add a response interceptor\najax.interceptors.response.use(\n  function (response) {\n    // Do something with response data\n    if (response.headers[\"x-token\"]) {\n      localStorage.setItem(\"x-token\", response.headers[\"x-token\"]);\n    }\n    return response;\n  },\n  function (error) {\n    // Do something with response error\n    return Promise.reject(error);\n  }\n);\nexport default ajax;\n"],"sourceRoot":""}